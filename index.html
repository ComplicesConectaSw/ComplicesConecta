<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#000000" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="ComplicesConecta" />
    <title>ComplicesConectaSW - Conecta Social Comunidad</title>
    <meta name="description" content="ComplicesConectaSW - Plataforma de conexión social" />
    <meta name="author" content="ComplicesConectaSW" />

    <meta property="og:title" content="ComplicesConectaSW - Conecta Social Comunidad" />
    <meta property="og:description" content="ComplicesConectaSW - Plataforma de conexión social" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/placeholder.svg" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@ComplicesConectaSW" />
    <meta name="twitter:image" content="/placeholder.svg" />
    <!-- CRÍTICO: Asegurar React disponible globalmente ANTES de chunks -->
    <script>
      // POLYFILL REACT: Asegurar que React.createContext esté disponible globalmente
      // Esto debe ejecutarse ANTES de que cualquier chunk se cargue
      if (typeof window !== 'undefined') {
        // Crear stub de React si no existe aún
        window.__REACT_POLYFILL__ = window.__REACT_POLYFILL__ || {};
        window.__REACT_POLYFILL__.createContext = window.__REACT_POLYFILL__.createContext || function(defaultValue) {
          var context = {
            _currentValue: defaultValue,
            Provider: null,
            Consumer: null
          };
          context.Provider = { _context: context };
          context.Consumer = { _context: context };
          return context;
        };
      }
    </script>
    <!-- SOLUCIÓN ALTERNATIVA: Hacer propiedades de wallet configurables ANTES de que las extensiones las toquen -->
    <script>
      // EJECUCIÓN INMEDIATA SIN IIFE - MÁXIMA PRIORIDAD
      var walletProtection = {
        originalDefineProperty: Object.defineProperty,
        originalConsoleError: console.error,
        originalConsoleWarn: console.warn
      };
      
      // Hacer propiedades configurables ANTES de que se definan
      var walletProps = ['ethereum', 'solana', 'tronWeb', 'tronweb', 'bybitWallet', 'bybit', 'chainId', 'chainid'];
      walletProps.forEach(function(prop) {
        try {
          var desc = Object.getOwnPropertyDescriptor(window, prop);
          if (desc && !desc.configurable) {
            try {
              Object.defineProperty(window, prop, {
                configurable: true,
                writable: desc.writable !== false,
                enumerable: desc.enumerable !== false,
                value: desc.value,
                get: desc.get,
                set: desc.set
              });
            } catch(e) {}
          }
        } catch(e) {}
      });
      
      // Interceptar Object.defineProperty
      Object.defineProperty = function(obj, prop, descriptor) {
        var propLower = String(prop).toLowerCase();
        if (obj === window && walletProps.some(function(wp) { return propLower === wp.toLowerCase(); })) {
          try {
            return walletProtection.originalDefineProperty.call(this, obj, prop, descriptor);
          } catch(e) {
            return obj;
          }
        }
        try {
          return walletProtection.originalDefineProperty.call(this, obj, prop, descriptor);
        } catch(e) {
          var errMsg = String(e && e.message || '').toLowerCase();
          if (walletProps.some(function(wp) { return propLower === wp.toLowerCase(); }) && obj === window) {
            return obj;
          }
          throw e;
        }
      };
      
      // Silenciar console
      console.error = function() {
        var msg = Array.prototype.join.call(arguments, ' ').toLowerCase();
        if (msg.indexOf('wallet') !== -1 || msg.indexOf('ethereum') !== -1 || msg.indexOf('solana') !== -1 ||
            msg.indexOf('metamask') !== -1 || msg.indexOf('tronweb') !== -1 || msg.indexOf('tronlink') !== -1 ||
            msg.indexOf('bybit') !== -1 || msg.indexOf('evmask') !== -1 || msg.indexOf('cannot redefine') !== -1 ||
            msg.indexOf('cannot assign to read only') !== -1 || msg.indexOf('read only property') !== -1 ||
            msg.indexOf('which has only a getter') !== -1 || msg.indexOf('inpage.js') !== -1 ||
            msg.indexOf('evmask.js') !== -1 || msg.indexOf('data-layer') !== -1 || msg.indexOf('solana.js') !== -1 ||
            msg.indexOf('dist.94abdbf1.js') !== -1 || msg.indexOf('chainid') !== -1) {
          return;
        }
        walletProtection.originalConsoleError.apply(console, arguments);
      };
      
      console.warn = function() {
        var msg = Array.prototype.join.call(arguments, ' ').toLowerCase();
        if (msg.indexOf('wallet') !== -1 || msg.indexOf('ethereum') !== -1 || msg.indexOf('solana') !== -1 ||
            msg.indexOf('metamask') !== -1 || msg.indexOf('tronweb') !== -1 || msg.indexOf('tronlink') !== -1 ||
            msg.indexOf('bybit') !== -1 || msg.indexOf('evmask') !== -1 || msg.indexOf('overwrite') !== -1) {
          return;
        }
        walletProtection.originalConsoleWarn.apply(console, arguments);
      };
      
      // Interceptar errores
      window.addEventListener('error', function(e) {
        var msg = String(e.message || '').toLowerCase();
        var filename = String(e.filename || '').toLowerCase();
        var stack = String(e.error && e.error.stack || '').toLowerCase();
        if (msg.indexOf('cannot redefine property') !== -1 || msg.indexOf('cannot assign to read only') !== -1 ||
            msg.indexOf('read only property') !== -1 || msg.indexOf('which has only a getter') !== -1 ||
            msg.indexOf('wallet') !== -1 || msg.indexOf('ethereum') !== -1 || msg.indexOf('solana') !== -1 ||
            msg.indexOf('metamask') !== -1 || msg.indexOf('tronweb') !== -1 || msg.indexOf('tronlink') !== -1 ||
            msg.indexOf('bybit') !== -1 || msg.indexOf('evmask') !== -1 ||
            filename.indexOf('inpage.js') !== -1 || filename.indexOf('evmask.js') !== -1 ||
            filename.indexOf('solana.js') !== -1 || filename.indexOf('data-layer') !== -1 ||
            filename.indexOf('dist.94abdbf1.js') !== -1 ||
            stack.indexOf('inpage.js') !== -1 || stack.indexOf('evmask.js') !== -1 ||
            stack.indexOf('solana.js') !== -1 || stack.indexOf('data-layer') !== -1) {
          e.stopImmediatePropagation();
          e.preventDefault();
          return false;
        }
      }, true);
      
      // Interceptar promise rejections
      window.addEventListener('unhandledrejection', function(e) {
        var reason = e.reason;
        var msg = String(reason && (reason.message || reason.toString()) || '').toLowerCase();
        var stack = String(reason && reason.stack || '').toLowerCase();
        var code = String(reason && reason.code || '').toLowerCase();
        if (msg.indexOf('cannot redefine property') !== -1 || msg.indexOf('cannot assign to read only') !== -1 ||
            msg.indexOf('read only property') !== -1 || msg.indexOf('which has only a getter') !== -1 ||
            msg.indexOf('wallet must') !== -1 || msg.indexOf('wallet') !== -1 ||
            msg.indexOf('ethereum') !== -1 || msg.indexOf('solana') !== -1 || msg.indexOf('metamask') !== -1 ||
            msg.indexOf('tronweb') !== -1 || msg.indexOf('tronlink') !== -1 || msg.indexOf('bybit') !== -1 ||
            msg.indexOf('evmask') !== -1 || msg.indexOf('chainid') !== -1 ||
            msg.indexOf('inpage.js') !== -1 || msg.indexOf('evmask.js') !== -1 || msg.indexOf('data-layer') !== -1 ||
            msg.indexOf('solana.js') !== -1 || msg.indexOf('dist.94abdbf1.js') !== -1 ||
            stack.indexOf('inpage.js') !== -1 || stack.indexOf('evmask.js') !== -1 ||
            stack.indexOf('data-layer') !== -1 || stack.indexOf('solana.js') !== -1 ||
            code === '4001' || (reason && typeof reason === 'object' && 'code' in reason && reason.code === 4001)) {
          e.stopImmediatePropagation();
          e.preventDefault();
          return false;
        }
      }, true);
    </script>
  </head>

  <body>
    <div id="root">
      <!-- Loading fallback - se reemplaza cuando React carga -->
      <div style="min-height: 100vh; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #6b21a8 0%, #3b82f6 100%);">
        <div style="color: white; text-align: center;">
          <div style="width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.3); border-top: 4px solid white; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
          <p>Cargando...</p>
        </div>
      </div>
    </div>
    <!-- Protección de wallets ANTES de que se carguen las extensiones -->
    <script>
      (function() {
        'use strict';
        // Protección ULTRA TEMPRANA - ANTES de que se carguen las extensiones de wallet
        const originalDefineProperty = Object.defineProperty;
        const originalConsoleError = console.error;
        const originalConsoleWarn = console.warn;
        
        // Silenciar console.error para wallets
        console.error = function(...args) {
          const msg = args.join(' ').toLowerCase();
          if (msg.includes('wallet') || msg.includes('ethereum') || msg.includes('solana') || 
              msg.includes('metamask') || msg.includes('tronweb') || msg.includes('tronlink') ||
              msg.includes('bybit') || msg.includes('evmask') || msg.includes('cannot redefine') ||
              msg.includes('cannot assign to read only') || msg.includes('read only property') ||
              msg.includes('which has only a getter') || msg.includes('inpage.js') ||
              msg.includes('evmAsk.js') || msg.includes('data-layer') || msg.includes('solana.js')) {
            return;
          }
          originalConsoleError.apply(console, args);
        };
        
        // Silenciar console.warn para wallets
        console.warn = function(...args) {
          const msg = args.join(' ').toLowerCase();
          if (msg.includes('wallet') || msg.includes('ethereum') || msg.includes('solana') ||
              msg.includes('metamask') || msg.includes('tronweb') || msg.includes('tronlink') ||
              msg.includes('bybit') || msg.includes('evmask')) {
            return;
          }
          originalConsoleWarn.apply(console, args);
        };
        
        // Interceptar Object.defineProperty para propiedades de wallet
        Object.defineProperty = function(obj, prop, descriptor) {
          const walletProps = ['ethereum', 'solana', 'tronWeb', 'bybitWallet', 'tronweb', 'chainId', 'chainid'];
          
          if (obj === window && walletProps.includes(prop.toLowerCase())) {
            try {
              const existing = Object.getOwnPropertyDescriptor(window, prop);
              if (existing && !existing.configurable) {
                // Propiedad no configurable, solo retornar sin error
                return obj;
              }
              return originalDefineProperty.call(this, obj, prop, descriptor);
            } catch {
              // Cualquier error, solo retornar sin error
              return obj;
            }
          }
          
          try {
            return originalDefineProperty.call(this, obj, prop, descriptor);
          } catch (error) {
            const errMsg = (error?.message || '').toLowerCase();
            if (walletProps.includes(prop.toLowerCase()) && obj === window &&
                (errMsg.includes('cannot redefine') || errMsg.includes('read only'))) {
              return obj;
            }
            throw error;
          }
        };
        
        // Interceptar errores globales
        window.addEventListener('error', function(e) {
          const msg = (e.message || '').toLowerCase();
          const filename = (e.filename || '').toLowerCase();
          
          if (msg.includes('cannot redefine property') || msg.includes('cannot assign to read only') ||
              msg.includes('read only property') || msg.includes('which has only a getter') ||
              msg.includes('wallet') || msg.includes('ethereum') || msg.includes('solana') ||
              filename.includes('inpage.js') || filename.includes('evmAsk.js') ||
              filename.includes('solana.js') || filename.includes('data-layer')) {
            e.stopImmediatePropagation();
            e.preventDefault();
            return false;
          }
        }, true);
        
        // Interceptar promise rejections
        window.addEventListener('unhandledrejection', function(e) {
          const reason = e.reason;
          const msg = (reason?.message || reason?.toString() || '').toLowerCase();
          const code = reason?.code?.toString() || '';
          
          if (msg.includes('cannot redefine property') || msg.includes('cannot assign to read only') ||
              msg.includes('read only property') || msg.includes('which has only a getter') ||
              msg.includes('wallet must') || msg.includes('wallet') ||
              msg.includes('ethereum') || msg.includes('solana') || msg.includes('metamask') ||
              msg.includes('tronweb') || msg.includes('tronlink') || msg.includes('bybit') ||
              msg.includes('inpage.js') || msg.includes('evmAsk.js') || msg.includes('data-layer') ||
              code === '4001' || (reason && typeof reason === 'object' && 'code' in reason && reason.code === 4001)) {
            e.stopImmediatePropagation();
            e.preventDefault();
            return false;
          }
        }, true);
      })();
    </script>
    <script type="module" src="/src/main.tsx"></script>
    <style>
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    </style>
  </body>
</html>
